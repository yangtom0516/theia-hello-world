{"version":3,"file":"main.js","mappings":"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","sources":["webpack://jake/./src/main.ts","webpack://jake/external commonjs \"vscode\"","webpack://jake/external node-commonjs \"child_process\"","webpack://jake/external node-commonjs \"fs\"","webpack://jake/external node-commonjs \"path\"","webpack://jake/webpack/bootstrap","webpack://jake/webpack/startup"],"sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as path from 'path';\nimport * as fs from 'fs';\nimport * as cp from 'child_process';\nimport * as vscode from 'vscode';\n\ntype AutoDetect = 'on' | 'off';\n\nfunction exists(file: string): Promise<boolean> {\n\treturn new Promise<boolean>((resolve, _reject) => {\n\t\tfs.exists(file, (value) => {\n\t\t\tresolve(value);\n\t\t});\n\t});\n}\n\nfunction exec(command: string, options: cp.ExecOptions): Promise<{ stdout: string; stderr: string }> {\n\treturn new Promise<{ stdout: string; stderr: string }>((resolve, reject) => {\n\t\tcp.exec(command, options, (error, stdout, stderr) => {\n\t\t\tif (error) {\n\t\t\t\treject({ error, stdout, stderr });\n\t\t\t}\n\t\t\tresolve({ stdout, stderr });\n\t\t});\n\t});\n}\n\nconst buildNames: string[] = ['build', 'compile', 'watch'];\nfunction isBuildTask(name: string): boolean {\n\tfor (const buildName of buildNames) {\n\t\tif (name.indexOf(buildName) !== -1) {\n\t\t\treturn true;\n\t\t}\n\t}\n\treturn false;\n}\n\nconst testNames: string[] = ['test'];\nfunction isTestTask(name: string): boolean {\n\tfor (const testName of testNames) {\n\t\tif (name.indexOf(testName) !== -1) {\n\t\t\treturn true;\n\t\t}\n\t}\n\treturn false;\n}\n\nlet _channel: vscode.OutputChannel;\nfunction getOutputChannel(): vscode.OutputChannel {\n\tif (!_channel) {\n\t\t_channel = vscode.window.createOutputChannel('Jake Auto Detection');\n\t}\n\treturn _channel;\n}\n\nfunction showError() {\n\tvscode.window.showWarningMessage(vscode.l10n.t(\"Problem finding jake tasks. See the output for more information.\"),\n\t\tvscode.l10n.t(\"Go to output\")).then(() => {\n\t\t\tgetOutputChannel().show(true);\n\t\t});\n}\n\nasync function findJakeCommand(rootPath: string): Promise<string> {\n\tlet jakeCommand: string;\n\tconst platform = process.platform;\n\tif (platform === 'win32' && await exists(path.join(rootPath!, 'node_modules', '.bin', 'jake.cmd'))) {\n\t\tjakeCommand = path.join('.', 'node_modules', '.bin', 'jake.cmd');\n\t} else if ((platform === 'linux' || platform === 'darwin') && await exists(path.join(rootPath!, 'node_modules', '.bin', 'jake'))) {\n\t\tjakeCommand = path.join('.', 'node_modules', '.bin', 'jake');\n\t} else {\n\t\tjakeCommand = 'jake';\n\t}\n\treturn jakeCommand;\n}\n\ninterface JakeTaskDefinition extends vscode.TaskDefinition {\n\ttask: string;\n\tfile?: string;\n}\n\nclass FolderDetector {\n\n\tprivate fileWatcher: vscode.FileSystemWatcher | undefined;\n\tprivate promise: Thenable<vscode.Task[]> | undefined;\n\n\tconstructor(\n\t\tprivate _workspaceFolder: vscode.WorkspaceFolder,\n\t\tprivate _jakeCommand: Promise<string>) {\n\t}\n\n\tpublic get workspaceFolder(): vscode.WorkspaceFolder {\n\t\treturn this._workspaceFolder;\n\t}\n\n\tpublic isEnabled(): boolean {\n\t\treturn vscode.workspace.getConfiguration('jake', this._workspaceFolder.uri).get<AutoDetect>('autoDetect') === 'on';\n\t}\n\n\tpublic start(): void {\n\t\tconst pattern = path.join(this._workspaceFolder.uri.fsPath, '{node_modules,Jakefile,Jakefile.js}');\n\t\tthis.fileWatcher = vscode.workspace.createFileSystemWatcher(pattern);\n\t\tthis.fileWatcher.onDidChange(() => this.promise = undefined);\n\t\tthis.fileWatcher.onDidCreate(() => this.promise = undefined);\n\t\tthis.fileWatcher.onDidDelete(() => this.promise = undefined);\n\t}\n\n\tpublic async getTasks(): Promise<vscode.Task[]> {\n\t\tif (this.isEnabled()) {\n\t\t\tif (!this.promise) {\n\t\t\t\tthis.promise = this.computeTasks();\n\t\t\t}\n\t\t\treturn this.promise;\n\t\t} else {\n\t\t\treturn [];\n\t\t}\n\t}\n\n\tpublic async getTask(_task: vscode.Task): Promise<vscode.Task | undefined> {\n\t\tconst jakeTask = (<any>_task.definition).task;\n\t\tif (jakeTask) {\n\t\t\tconst kind: JakeTaskDefinition = (<any>_task.definition);\n\t\t\tconst options: vscode.ShellExecutionOptions = { cwd: this.workspaceFolder.uri.fsPath };\n\t\t\tconst task = new vscode.Task(kind, this.workspaceFolder, jakeTask, 'jake', new vscode.ShellExecution(await this._jakeCommand, [jakeTask], options));\n\t\t\treturn task;\n\t\t}\n\t\treturn undefined;\n\t}\n\n\tprivate async computeTasks(): Promise<vscode.Task[]> {\n\t\tconst rootPath = this._workspaceFolder.uri.scheme === 'file' ? this._workspaceFolder.uri.fsPath : undefined;\n\t\tconst emptyTasks: vscode.Task[] = [];\n\t\tif (!rootPath) {\n\t\t\treturn emptyTasks;\n\t\t}\n\t\tlet jakefile = path.join(rootPath, 'Jakefile');\n\t\tif (!await exists(jakefile)) {\n\t\t\tjakefile = path.join(rootPath, 'Jakefile.js');\n\t\t\tif (! await exists(jakefile)) {\n\t\t\t\treturn emptyTasks;\n\t\t\t}\n\t\t}\n\n\t\tconst commandLine = `${await this._jakeCommand} --tasks`;\n\t\ttry {\n\t\t\tconst { stdout, stderr } = await exec(commandLine, { cwd: rootPath });\n\t\t\tif (stderr) {\n\t\t\t\tgetOutputChannel().appendLine(stderr);\n\t\t\t\tshowError();\n\t\t\t}\n\t\t\tconst result: vscode.Task[] = [];\n\t\t\tif (stdout) {\n\t\t\t\tconst lines = stdout.split(/\\r{0,1}\\n/);\n\t\t\t\tfor (const line of lines) {\n\t\t\t\t\tif (line.length === 0) {\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\tconst regExp = /^jake\\s+([^\\s]+)\\s/g;\n\t\t\t\t\tconst matches = regExp.exec(line);\n\t\t\t\t\tif (matches && matches.length === 2) {\n\t\t\t\t\t\tconst taskName = matches[1];\n\t\t\t\t\t\tconst kind: JakeTaskDefinition = {\n\t\t\t\t\t\t\ttype: 'jake',\n\t\t\t\t\t\t\ttask: taskName\n\t\t\t\t\t\t};\n\t\t\t\t\t\tconst options: vscode.ShellExecutionOptions = { cwd: this.workspaceFolder.uri.fsPath };\n\t\t\t\t\t\tconst task = new vscode.Task(kind, taskName, 'jake', new vscode.ShellExecution(`${await this._jakeCommand} ${taskName}`, options));\n\t\t\t\t\t\tresult.push(task);\n\t\t\t\t\t\tconst lowerCaseLine = line.toLowerCase();\n\t\t\t\t\t\tif (isBuildTask(lowerCaseLine)) {\n\t\t\t\t\t\t\ttask.group = vscode.TaskGroup.Build;\n\t\t\t\t\t\t} else if (isTestTask(lowerCaseLine)) {\n\t\t\t\t\t\t\ttask.group = vscode.TaskGroup.Test;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn result;\n\t\t} catch (err) {\n\t\t\tconst channel = getOutputChannel();\n\t\t\tif (err.stderr) {\n\t\t\t\tchannel.appendLine(err.stderr);\n\t\t\t}\n\t\t\tif (err.stdout) {\n\t\t\t\tchannel.appendLine(err.stdout);\n\t\t\t}\n\t\t\tchannel.appendLine(vscode.l10n.t(\"Auto detecting Jake for folder {0} failed with error: {1}', this.workspaceFolder.name, err.error ? err.error.toString() : 'unknown\"));\n\t\t\tshowError();\n\t\t\treturn emptyTasks;\n\t\t}\n\t}\n\n\tpublic dispose() {\n\t\tthis.promise = undefined;\n\t\tif (this.fileWatcher) {\n\t\t\tthis.fileWatcher.dispose();\n\t\t}\n\t}\n}\n\nclass TaskDetector {\n\n\tprivate taskProvider: vscode.Disposable | undefined;\n\tprivate detectors: Map<string, FolderDetector> = new Map();\n\n\tconstructor() {\n\t}\n\n\tpublic start(): void {\n\t\tconst folders = vscode.workspace.workspaceFolders;\n\t\tif (folders) {\n\t\t\tthis.updateWorkspaceFolders(folders, []);\n\t\t}\n\t\tvscode.workspace.onDidChangeWorkspaceFolders((event) => this.updateWorkspaceFolders(event.added, event.removed));\n\t\tvscode.workspace.onDidChangeConfiguration(this.updateConfiguration, this);\n\t}\n\n\tpublic dispose(): void {\n\t\tif (this.taskProvider) {\n\t\t\tthis.taskProvider.dispose();\n\t\t\tthis.taskProvider = undefined;\n\t\t}\n\t\tthis.detectors.clear();\n\t}\n\n\tprivate updateWorkspaceFolders(added: readonly vscode.WorkspaceFolder[], removed: readonly vscode.WorkspaceFolder[]): void {\n\t\tfor (const remove of removed) {\n\t\t\tconst detector = this.detectors.get(remove.uri.toString());\n\t\t\tif (detector) {\n\t\t\t\tdetector.dispose();\n\t\t\t\tthis.detectors.delete(remove.uri.toString());\n\t\t\t}\n\t\t}\n\t\tfor (const add of added) {\n\t\t\tconst detector = new FolderDetector(add, findJakeCommand(add.uri.fsPath));\n\t\t\tthis.detectors.set(add.uri.toString(), detector);\n\t\t\tif (detector.isEnabled()) {\n\t\t\t\tdetector.start();\n\t\t\t}\n\t\t}\n\t\tthis.updateProvider();\n\t}\n\n\tprivate updateConfiguration(): void {\n\t\tfor (const detector of this.detectors.values()) {\n\t\t\tdetector.dispose();\n\t\t\tthis.detectors.delete(detector.workspaceFolder.uri.toString());\n\t\t}\n\t\tconst folders = vscode.workspace.workspaceFolders;\n\t\tif (folders) {\n\t\t\tfor (const folder of folders) {\n\t\t\t\tif (!this.detectors.has(folder.uri.toString())) {\n\t\t\t\t\tconst detector = new FolderDetector(folder, findJakeCommand(folder.uri.fsPath));\n\t\t\t\t\tthis.detectors.set(folder.uri.toString(), detector);\n\t\t\t\t\tif (detector.isEnabled()) {\n\t\t\t\t\t\tdetector.start();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tthis.updateProvider();\n\t}\n\n\tprivate updateProvider(): void {\n\t\tif (!this.taskProvider && this.detectors.size > 0) {\n\t\t\tconst thisCapture = this;\n\t\t\tthis.taskProvider = vscode.tasks.registerTaskProvider('jake', {\n\t\t\t\tprovideTasks(): Promise<vscode.Task[]> {\n\t\t\t\t\treturn thisCapture.getTasks();\n\t\t\t\t},\n\t\t\t\tresolveTask(_task: vscode.Task): Promise<vscode.Task | undefined> {\n\t\t\t\t\treturn thisCapture.getTask(_task);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\telse if (this.taskProvider && this.detectors.size === 0) {\n\t\t\tthis.taskProvider.dispose();\n\t\t\tthis.taskProvider = undefined;\n\t\t}\n\t}\n\n\tpublic getTasks(): Promise<vscode.Task[]> {\n\t\treturn this.computeTasks();\n\t}\n\n\tprivate computeTasks(): Promise<vscode.Task[]> {\n\t\tif (this.detectors.size === 0) {\n\t\t\treturn Promise.resolve([]);\n\t\t} else if (this.detectors.size === 1) {\n\t\t\treturn this.detectors.values().next().value!.getTasks();\n\t\t} else {\n\t\t\tconst promises: Promise<vscode.Task[]>[] = [];\n\t\t\tfor (const detector of this.detectors.values()) {\n\t\t\t\tpromises.push(detector.getTasks().then((value) => value, () => []));\n\t\t\t}\n\t\t\treturn Promise.all(promises).then((values) => {\n\t\t\t\tconst result: vscode.Task[] = [];\n\t\t\t\tfor (const tasks of values) {\n\t\t\t\t\tif (tasks && tasks.length > 0) {\n\t\t\t\t\t\tresult.push(...tasks);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn result;\n\t\t\t});\n\t\t}\n\t}\n\n\tpublic async getTask(task: vscode.Task): Promise<vscode.Task | undefined> {\n\t\tif (this.detectors.size === 0) {\n\t\t\treturn undefined;\n\t\t} else if (this.detectors.size === 1) {\n\t\t\treturn this.detectors.values().next().value!.getTask(task);\n\t\t} else {\n\t\t\tif ((task.scope === vscode.TaskScope.Workspace) || (task.scope === vscode.TaskScope.Global)) {\n\t\t\t\t// Not supported, we don't have enough info to create the task.\n\t\t\t\treturn undefined;\n\t\t\t} else if (task.scope) {\n\t\t\t\tconst detector = this.detectors.get(task.scope.uri.toString());\n\t\t\t\tif (detector) {\n\t\t\t\t\treturn detector.getTask(task);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn undefined;\n\t\t}\n\t}\n}\n\nlet detector: TaskDetector;\nexport function activate(_context: vscode.ExtensionContext): void {\n\tdetector = new TaskDetector();\n\tdetector.start();\n}\n\nexport function deactivate(): void {\n\tdetector.dispose();\n}\n","module.exports = require(\"vscode\");","module.exports = require(\"child_process\");","module.exports = require(\"fs\");","module.exports = require(\"path\");","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// startup\n// Load entry module and return exports\n// This entry module is referenced by other modules so it can't be inlined\nvar __webpack_exports__ = __webpack_require__(184);\n"],"names":["_context","detector","TaskDetector","start","dispose","exists","file","Promise","resolve","_reject","fs","value","buildNames","isBuildTask","name","buildName","indexOf","testNames","isTestTask","testName","_channel","getOutputChannel","vscode","window","createOutputChannel","showError","showWarningMessage","l10n","t","then","show","async","findJakeCommand","rootPath","jakeCommand","platform","process","path","join","FolderDetector","constructor","_workspaceFolder","_jakeCommand","workspaceFolder","this","isEnabled","workspace","getConfiguration","uri","get","pattern","fsPath","fileWatcher","createFileSystemWatcher","onDidChange","promise","undefined","onDidCreate","onDidDelete","getTasks","computeTasks","getTask","_task","jakeTask","definition","task","kind","options","cwd","Task","ShellExecution","scheme","emptyTasks","jakefile","commandLine","stdout","stderr","command","reject","cp","exec","error","appendLine","result","lines","split","line","length","matches","taskName","type","push","lowerCaseLine","toLowerCase","group","TaskGroup","Build","Test","err","channel","detectors","Map","folders","workspaceFolders","updateWorkspaceFolders","onDidChangeWorkspaceFolders","event","added","removed","onDidChangeConfiguration","updateConfiguration","taskProvider","clear","remove","toString","delete","add","set","updateProvider","values","folder","has","size","thisCapture","tasks","registerTaskProvider","provideTasks","resolveTask","next","promises","all","scope","TaskScope","Workspace","Global","module","exports","require","__webpack_module_cache__","__webpack_exports__","__webpack_require__","moduleId","cachedModule","__webpack_modules__","call"],"sourceRoot":""}